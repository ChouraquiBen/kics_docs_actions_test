{
  "id": "d3e1f5a9-bb45-4c89-b97c-12d34ef56789",
  "queryName": "Elasticsearch Uses Default Security Group",
  "severity": "HIGH",
  "category": "Networking and Firewall",
  "descriptionText": "Ensures that AWS Elasticsearch and OpenSearch domains do not use the default security group. If a security group is not specified, the default SG is used, which could expose the service to unintended access.",
  "descriptionUrl": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#vpc_options",
  "platform": "Terraform",
  "descriptionID": "d3e1f5a9",
  "cloudProvider": "aws",
  "cwe": "400",
  "detailedDescriptionText": "Elasticsearch domains should use explicitly defined security groups instead of default security groups to control network access.\n\nDefault security groups often have overly permissive rules that allow inbound traffic from other resources using the same default group. This can inadvertently expose Elasticsearch endpoints to unintended access from other services in the same VPC, potentially allowing unauthorized data access or modification.\n\nExplicitly specify security groups in the vpc_options block of your aws_elasticsearch_domain resource by providing a list of security group IDs. Create purpose-specific security groups that allow only the necessary traffic from authorized sources. Review and audit security group rules regularly to ensure they maintain the principle of least privilege."
}
