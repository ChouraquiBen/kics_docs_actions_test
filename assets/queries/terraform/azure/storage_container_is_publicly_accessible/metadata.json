{
  "id": "dd5230f8-a577-4bbb-b7ac-f2c2fe7d5299",
  "queryName": "Storage Container Is Publicly Accessible",
  "severity": "HIGH",
  "category": "Access Control",
  "descriptionText": "Anonymous, public read access to a container and its blobs are enabled in Azure Blob Storage",
  "descriptionUrl": "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_container#container_access_type",
  "platform": "Terraform",
  "descriptionID": "a9e178f3",
  "cloudProvider": "azure",
  "cwe": "285",
  "detailedDescriptionText": "Publicly accessible Azure Storage containers pose a high security risk by exposing potentially sensitive data to anyone on the internet without authentication. When the 'container_access_type' attribute is set to 'blob' or 'container', it allows anonymous read access to blob data, which violates the principle of least privilege and can lead to data breaches, unauthorized data access, and potential compliance violations.\n\nVulnerable examples:\n```terraform\n# Public blob-level access enabled\nresource \"azurerm_storage_container\" \"vulnerable1\" {\n  name                  = \"vhds\"\n  storage_account_name  = azurerm_storage_account.example.name\n  container_access_type = \"blob\"    # Vulnerability: Allows anonymous access to individual blobs\n}\n\n# Public container-level access enabled (even more permissive)\nresource \"azurerm_storage_container\" \"vulnerable2\" {\n  name                  = \"documents\"\n  storage_account_name  = azurerm_storage_account.example.name\n  container_access_type = \"container\"    # Vulnerability: Allows anonymous access to the container and all blobs\n}\n```\n\nSecure examples:\n```terraform\n# Explicit private access\nresource \"azurerm_storage_container\" \"secure1\" {\n  name                  = \"vhds\"\n  storage_account_name  = azurerm_storage_account.example.name\n  container_access_type = \"private\"    # Secure: No anonymous access allowed\n}\n\n# Default private access (container_access_type defaults to 'private' when not specified)\nresource \"azurerm_storage_container\" \"secure2\" {\n  name                  = \"vhds2\"\n  storage_account_name  = azurerm_storage_account.example.name\n  # container_access_type is not specified, so defaults to \"private\"\n}\n```\n\nMitigation strategies:\n1. Set 'container_access_type' to 'private' or omit it (as it defaults to 'private')\n2. Use Shared Access Signatures (SAS) with appropriate time limits for temporary access\n3. Implement Azure Active Directory authentication for controlled access\n4. Use Azure Storage private endpoints to restrict network access\n5. Enable Storage Account firewall rules to limit access to specific networks\n6. Implement audit logging for storage access\n7. Use Azure Policy to enforce private-only container access types\n8. Consider Azure RBAC for fine-grained access control to storage resources\n9. Regularly audit storage container access settings\n10. For content that must be publicly served, consider using Azure CDN with proper security controls"
}